── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.2
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.1.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

Attaching package: ‘mice’

The following object is masked from ‘package:stats’:

    filter

The following objects are masked from ‘package:base’:

    cbind, rbind


Attaching package: ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric

Processing intake data...
Processing panel data...

Applying outlier detection (±3σ) to Sleep duration and MSFsc...
Sleep duration (total_hours_sleep):
  Outlier detection: 31 values outside ±3σ [3.44, 10.98] set to NA
MSFsc (msf_sc_numeric):
  Outlier detection: 45 values outside ±3σ [-6.58, 21.01] set to NA
Processing gaming data...

Attaching package: ‘data.table’

The following objects are masked from ‘package:zoo’:

    yearmon, yearqtr

The following objects are masked from ‘package:lubridate’:

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year

The following objects are masked from ‘package:dplyr’:

    between, first, last

The following object is masked from ‘package:purrr’:

    transpose

Calculated day 0 for 1948 participants

=== STEP 1: Outcome Measure Filter ===
Participants with valid outcome data: 1843
Participants WITHOUT outcome data: 105 (excluded)

=== STEP 2: Timezone Data Filter ===
Total participants in intake: 34922
Participants with valid timezone data: 33876
  - Reported timezone: 21788
  - Imputed UK timezone (GMT): 12088
Participants WITHOUT timezone data: 1046 (excluded - US only)

Combined Filter (Outcomes AND Timezone):
  With outcomes AND timezone: 1723
  With outcomes but NO timezone: 120 (excluded - US participants or no intake)
Loading gaming data...
Combining and filtering gaming data...

=== Gaming Data After Quality & Study Window Filters ===
Sessions: 363833
Participants: 1644

=== STEP 3: Gaming Data Filter ===
Participants with at least one valid gaming session: 1644

Combined Filter (Outcomes AND Timezone AND Gaming):
  With outcomes, timezone AND gaming: 1580
  With outcomes & timezone but NO gaming: 143 (excluded)

=== FINAL VALID SAMPLE ===
Final participants: 1580
Final sessions: 352278

Excluded in final step:
  Participants: 64 (had gaming but no outcomes or timezone)
  Sessions: 11555

Exporting gaming sessions...
Creating gaming sessions export with late-night enrichment...
Exported 352278 gaming sessions from 1580 participants

Creating self-report data...
Creating self-report data...

Applying outlier detection (±3σ) to Sleep duration and MSFsc...
Sleep duration (total_hours_sleep):
  Outlier detection: 31 values outside ±3σ [3.44, 10.98] set to NA
MSFsc (msf_sc_numeric):
  Outlier detection: 45 values outside ±3σ [-6.58, 21.01] set to NA
Created 6259 self-report records from 1580 participants
  (Filtered to valid participants who passed 3-step filter)

Saving processed data...
  - Wrote raw self-report data to data/processed/selfreport_raw.csv.gz

Preparing data for imputation (wave expansion, date filling, gaming exposures)...
=== Multiple Imputation for Self-Report Variables ===

Loading data...
  Loaded 9462 observations from 1577 participants
Error in `filter()`:
ℹ In argument: `is.na(wemwbs)`.
Caused by error:
! object 'wemwbs' not found
Backtrace:
     ▆
  1. ├─global preprocess_all_data()
  2. │ ├─base::source("imputation.R", local = TRUE)
  3. │ │ ├─base::withVisible(eval(ei, envir))
  4. │ │ └─base::eval(ei, envir)
  5. │ │   └─base::eval(ei, envir)
  6. │ └─run_imputation(...)
  7. │   └─... %>% pull(pid)
  8. ├─dplyr::pull(., pid)
  9. ├─dplyr::distinct(., pid)
 10. ├─dplyr::filter(., wave == 1, is.na(wemwbs))
 11. ├─dplyr:::filter.data.frame(., wave == 1, is.na(wemwbs))
 12. │ └─dplyr:::filter_rows(.data, dots, by)
 13. │   └─dplyr:::filter_eval(...)
 14. │     ├─base::withCallingHandlers(...)
 15. │     └─mask$eval_all_filter(dots, env_filter)
 16. │       └─dplyr (local) eval()
 17. └─base::.handleSimpleError(...)
 18.   └─dplyr (local) h(simpleError(msg, call))
 19.     └─rlang::abort(message, class = error_class, parent = parent, call = error_call)
Warning messages:
1: One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat <- vroom(...)
  problems(dat) 
2: There were 8 warnings in `mutate()`.
The first warning was:
ℹ In argument: `eps_reading_num = case_when(...)`.
Caused by warning:
! NAs introduced by coercion
ℹ Run `dplyr::last_dplyr_warnings()` to see the 7 remaining warnings. 
3: There were 4 warnings in `mutate()`.
The first warning was:
ℹ In argument: `slat_w =
  lubridate::dminutes(as.numeric(mctq_wd_sleep_latency_minutes))`.
Caused by warning in `initialize()`:
! NAs introduced by coercion
ℹ Run `dplyr::last_dplyr_warnings()` to see the 3 remaining warnings. 
4: There were 8 warnings in `mutate()`.
The first warning was:
ℹ In argument: `eps_reading_num = case_when(...)`.
Caused by warning:
! NAs introduced by coercion
ℹ Run `dplyr::last_dplyr_warnings()` to see the 7 remaining warnings. 
5: There were 4 warnings in `mutate()`.
The first warning was:
ℹ In argument: `slat_w =
  lubridate::dminutes(as.numeric(mctq_wd_sleep_latency_minutes))`.
Caused by warning in `initialize()`:
! NAs introduced by coercion
ℹ Run `dplyr::last_dplyr_warnings()` to see the 3 remaining warnings. 
Execution halted
